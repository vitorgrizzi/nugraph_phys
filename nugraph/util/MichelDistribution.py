import numpy as np

## True data, n_bins = 70
data_pdf = np.array([3.29917717e-02, 2.88848046e-02, 2.50499080e-02, 2.37154675e-02,
                     2.49721736e-02, 2.54515356e-02, 2.77058330e-02, 2.99018296e-02,
                     3.15277740e-02, 3.31472405e-02, 3.56930418e-02, 3.75651451e-02,
                     3.92299567e-02, 4.01044686e-02, 4.24559340e-02, 4.23781996e-02,
                     4.31555435e-02, 4.38810645e-02, 4.43474709e-02, 4.49175231e-02,
                     4.32462336e-02, 4.16008557e-02, 4.05579192e-02, 3.91975674e-02,
                     3.66258546e-02, 3.49610430e-02, 3.19099681e-02, 2.95390691e-02,
                     2.61058001e-02, 2.32425833e-02, 2.03534551e-02, 1.70756549e-02,
                     1.43355175e-02, 1.15759466e-02, 8.80989781e-03, 6.96370599e-03,
                     5.39606241e-03, 4.15878999e-03, 3.60817138e-03, 2.94742905e-03,
                     2.53932349e-03, 2.30612031e-03, 2.20247445e-03, 2.09882859e-03,
                     1.87210328e-03, 1.84619182e-03, 1.70367877e-03, 1.52877638e-03,
                     1.48343132e-03, 1.30205107e-03, 1.22431668e-03, 1.07532576e-03,
                     1.07532576e-03, 1.02350283e-03, 8.09733254e-04, 7.64388192e-04,
                     5.50618613e-04, 6.15397273e-04, 4.34017024e-04, 5.44140747e-04,
                     3.82194096e-04, 3.17415436e-04, 2.52636775e-04, 2.13769579e-04,
                     2.52636775e-04, 2.00813847e-04, 8.42122584e-05, 9.71679905e-05,
                     1.29557321e-04, 9.06901245e-05])

data_bins_center = np.array([ 0.42876999,  1.28470789,  2.14064579,  2.9965837 ,  3.8525216 ,
                              4.70845951,  5.56439741,  6.42033531,  7.27627322,  8.13221112,
                              8.98814903,  9.84408693, 10.70002483, 11.55596274, 12.41190064,
                             13.26783855, 14.12377645, 14.97971435, 15.83565226, 16.69159016,
                             17.54752807, 18.40346597, 19.25940387, 20.11534178, 20.97127968,
                             21.82721759, 22.68315549, 23.53909339, 24.3950313 , 25.2509692 ,
                             26.10690711, 26.96284501, 27.81878291, 28.67472082, 29.53065872,
                             30.38659663, 31.24253453, 32.09847243, 32.95441034, 33.81034824,
                             34.66628615, 35.52222405, 36.37816195, 37.23409986, 38.09003776,
                             38.94597567, 39.80191357, 40.65785147, 41.51378938, 42.36972728,
                             43.22566519, 44.08160309, 44.93754099, 45.7934789 , 46.6494168 ,
                             47.50535471, 48.36129261, 49.21723051, 50.07316842, 50.92910632,
                             51.78504423, 52.64098213, 53.49692003, 54.35285794, 55.20879584,
                             56.06473375, 56.92067165, 57.77660956, 58.63254746, 59.48848536])


## Landau distribution (single peak), n_bins = 80
landau_pdf = np.array([0.01279459, 0.01505842, 0.01747246, 0.01999547, 0.02258024,
                       0.0251768 , 0.02773606, 0.03021366, 0.03257322, 0.03478882,
                       0.03684613, 0.03874199, 0.04048243, 0.04207935, 0.04354615,
                       0.04489314, 0.04612314, 0.04722824, 0.04818799, 0.04896962,
                       0.0495301 , 0.04982008, 0.04931425, 0.04795854, 0.04757576,
                       0.04679001, 0.04538712, 0.04346971, 0.04113357, 0.03846294,
                       0.03554157, 0.03245549, 0.02929092, 0.02613046, 0.02304911,
                       0.02011092, 0.01736671, 0.01485301, 0.01259213, 0.01059321,
                       0.00885407, 0.00736339, 0.00610316, 0.00505099, 0.00418225,
                       0.00347178, 0.00289528, 0.00243025, 0.00205654, 0.00175667,
                       0.00151582, 0.00132172, 0.0011644 , 0.00103591, 0.00092994,
                       0.00084163, 0.0007672 , 0.00070373, 0.00064903, 0.00060139,
                       0.00055951, 0.00052238, 0.00048921, 0.00045939, 0.00043246,
                       0.00040801, 0.00038571, 0.0003653 , 0.00034655, 0.00032927,
                       0.0003133 , 0.00029851, 0.00028479, 0.00027202, 0.00026011,
                       0.00024899, 0.00023859, 0.00022885, 0.0002197 , 0.0002111 ])

landau_bins_center = np.array([ 0.        ,  0.75949367,  1.51898734,  2.27848101,  3.03797468,
                                3.79746835,  4.55696203,  5.3164557 ,  6.07594937,  6.83544304,
                                7.59493671,  8.35443038,  9.11392405,  9.87341772, 10.63291139,
                               11.39240506, 12.15189873, 12.91139241, 13.67088608, 14.43037975,
                               15.18987342, 15.94936709, 16.70886076, 17.46835443, 18.2278481 ,
                               18.98734177, 19.74683544, 20.50632911, 21.26582278, 22.02531646,
                               22.78481013, 23.5443038 , 24.30379747, 25.06329114, 25.82278481,
                               26.58227848, 27.34177215, 28.10126582, 28.86075949, 29.62025316,
                               30.37974684, 31.13924051, 31.89873418, 32.65822785, 33.41772152,
                               34.17721519, 34.93670886, 35.69620253, 36.4556962 , 37.21518987,
                               37.97468354, 38.73417722, 39.49367089, 40.25316456, 41.01265823,
                               41.7721519 , 42.53164557, 43.29113924, 44.05063291, 44.81012658,
                               45.56962025, 46.32911392, 47.08860759, 47.84810127, 48.60759494,
                               49.36708861, 50.12658228, 50.88607595, 51.64556962, 52.40506329,
                               53.16455696, 53.92405063, 54.6835443 , 55.44303797, 56.20253165,
                               56.96202532, 57.72151899, 58.48101266, 59.24050633, 60.        ])

data_pdf2 = np.array([1.33549791e-02, 7.76495318e-03, 7.14486752e-03, 6.82094218e-03,
       6.74690211e-03, 7.64463805e-03, 8.40354885e-03, 8.79225926e-03,
       9.20873470e-03, 9.96764550e-03, 1.09949516e-02, 1.12726019e-02,
       1.25497932e-02, 1.31421138e-02, 1.35400793e-02, 1.46506804e-02,
       1.47154655e-02, 1.50856659e-02, 1.53170411e-02, 1.58723417e-02,
       1.68718828e-02, 1.67330576e-02, 1.61407370e-02, 1.57705366e-02,
       1.61407370e-02, 1.57890466e-02, 1.66682726e-02, 1.60296769e-02,
       1.60481869e-02, 1.49838608e-02, 1.47802506e-02, 1.38454946e-02,
       1.41509099e-02, 1.26978734e-02, 1.13836620e-02, 1.13281319e-02,
       1.08376164e-02, 9.51415002e-03, 8.91257439e-03, 8.21844866e-03,
       7.81122823e-03, 6.34893669e-03, 5.65481096e-03, 4.96068522e-03,
       4.37761961e-03, 3.65572885e-03, 3.08191825e-03, 2.49885263e-03,
       2.28598741e-03, 1.89727700e-03, 1.49931158e-03, 1.38825146e-03,
       1.06432612e-03, 1.09209115e-03, 9.71776023e-04, 8.88480936e-04,
       6.75615712e-04, 7.03380741e-04, 8.23695868e-04, 6.57105692e-04,
       7.03380741e-04, 6.29340663e-04, 7.21890760e-04, 5.36790565e-04,
       5.73810604e-04, 4.53495478e-04, 4.44240468e-04, 4.34985458e-04,
       3.51690370e-04, 2.96160312e-04, 2.77650292e-04, 2.96160312e-04,
       2.86905302e-04, 2.86905302e-04, 3.33180351e-04, 2.31375244e-04,
       2.31375244e-04, 1.94355205e-04, 1.66590175e-04, 1.38825146e-04,
       1.11060117e-04, 1.11060117e-04, 7.40400780e-05, 1.01805107e-04])

data_bins_center2 = np.array([  0.893404  ,   2.67860993,   4.46381586,   6.2490218 ,
         8.03422773,   9.81943366,  11.60463959,  13.38984553,
        15.17505146,  16.96025739,  18.74546332,  20.53066926,
        22.31587519,  24.10108112,  25.88628705,  27.67149299,
        29.45669892,  31.24190485,  33.02711078,  34.81231672,
        36.59752265,  38.38272858,  40.16793452,  41.95314045,
        43.73834638,  45.52355231,  47.30875825,  49.09396418,
        50.87917011,  52.66437604,  54.44958198,  56.23478791,
        58.01999384,  59.80519977,  61.59040571,  63.37561164,
        65.16081757,  66.9460235 ,  68.73122944,  70.51643537,
        72.3016413 ,  74.08684723,  75.87205317,  77.6572591 ,
        79.44246503,  81.22767096,  83.0128769 ,  84.79808283,
        86.58328876,  88.36849469,  90.15370063,  91.93890656,
        93.72411249,  95.50931842,  97.29452436,  99.07973029,
       100.86493622, 102.65014215, 104.43534809, 106.22055402,
       108.00575995, 109.79096588, 111.57617182, 113.36137775,
       115.14658368, 116.93178961, 118.71699555, 120.50220148,
       122.28740741, 124.07261334, 125.85781928, 127.64302521,
       129.42823114, 131.21343707, 132.99864301, 134.78384894,
       136.56905487, 138.3542608 , 140.13946674, 141.92467267,
       143.7098786 , 145.49508453, 147.28029047, 149.0654964 ])

landau_pdf2 = 3*np.array([0.00405464, 0.00458935, 0.00516607, 0.00578334, 0.00643882,
       0.00712924, 0.00785036, 0.00859698, 0.00936292, 0.01014113,
       0.01092373, 0.01170213, 0.01246719, 0.01320935, 0.01391887,
       0.01458599, 0.01520118, 0.01575536, 0.0162401 , 0.01664787,
       0.01697223, 0.01720834, 0.0173547 , 0.01741738, 0.01741469,
       0.01737529, 0.01732599, 0.0172766 , 0.01721334, 0.01710478,
       0.01691509, 0.01661618, 0.01619408, 0.01564958, 0.01499501,
       0.01424989, 0.01343685, 0.01257864, 0.01169632, 0.01080827,
       0.00992986, 0.00907351, 0.00824895, 0.00746349, 0.00672238,
       0.00602911, 0.00538569, 0.0047929 , 0.00425051, 0.00375746,
       0.00331204, 0.00291203, 0.00255484, 0.00223761, 0.00195733,
       0.00171091, 0.00149528, 0.0013074 , 0.00114436, 0.0010034 ,
       0.00088192, 0.00077752, 0.000688  , 0.00061137, 0.00054584,
       0.00048983, 0.00044193, 0.00040092, 0.00036574, 0.00033547,
       0.00030933, 0.00028665, 0.00026687, 0.00024953, 0.00023422,
       0.00022063, 0.00020847, 0.00019753, 0.00018762, 0.00017859,
       0.00017032, 0.00016269, 0.00015564, 0.00014908, 0.00014296,
       0.00013724, 0.00013187, 0.00012682, 0.00012206, 0.00011756])

landau_bins_center2 = np.array([  0.        ,   1.68539326,   3.37078652,   5.05617978,
         6.74157303,   8.42696629,  10.11235955,  11.79775281,
        13.48314607,  15.16853933,  16.85393258,  18.53932584,
        20.2247191 ,  21.91011236,  23.59550562,  25.28089888,
        26.96629213,  28.65168539,  30.33707865,  32.02247191,
        33.70786517,  35.39325843,  37.07865169,  38.76404494,
        40.4494382 ,  42.13483146,  43.82022472,  45.50561798,
        47.19101124,  48.87640449,  50.56179775,  52.24719101,
        53.93258427,  55.61797753,  57.30337079,  58.98876404,
        60.6741573 ,  62.35955056,  64.04494382,  65.73033708,
        67.41573034,  69.1011236 ,  70.78651685,  72.47191011,
        74.15730337,  75.84269663,  77.52808989,  79.21348315,
        80.8988764 ,  82.58426966,  84.26966292,  85.95505618,
        87.64044944,  89.3258427 ,  91.01123596,  92.69662921,
        94.38202247,  96.06741573,  97.75280899,  99.43820225,
       101.12359551, 102.80898876, 104.49438202, 106.17977528,
       107.86516854, 109.5505618 , 111.23595506, 112.92134831,
       114.60674157, 116.29213483, 117.97752809, 119.66292135,
       121.34831461, 123.03370787, 124.71910112, 126.40449438,
       128.08988764, 129.7752809 , 131.46067416, 133.14606742,
       134.83146067, 136.51685393, 138.20224719, 139.88764045,
       141.57303371, 143.25842697, 144.94382022, 146.62921348,
       148.31460674, 150.        ])


def get_pdf_value(edep, distribution='true_data'):
    """Get the PDF from the relevant distribution, which can be `data`, `landau`, and `double_peaked`"""

    if distribution == 'data':
        closest_idx = np.argmin(np.abs(edep - data_bins_center2))
        pdf = data_pdf2[closest_idx]

    elif distribution == 'landau':
        closest_idx = np.argmin(np.abs(edep - landau_bins_center2))
        pdf = landau_pdf2[closest_idx]

    else:
        raise Exception('invalid distribution')

    return pdf